<ion-view view-title="Requested Visits">
  <ion-nav-buttons side="secondary" class="show">
    <button class="button button-clear icon ion-plus-circled" ng-click="pendingVisits.showRequestVisitModal()">
    </button>
  </ion-nav-buttons>
  <ion-content class="has-header">
    <ion-list show-delete="pendingVisits.showDelete" can-swipe="pendingVisits.canSwipe">
      <div ng-repeat="dateVisits in pendingVisits.pendingVisits">
        <div class="item item-divider">
          {{dateVisits.date|date:'longDate'}}
        </div>
        <ion-item ng-repeat="visit in dateVisits.visits" class="item-avatar"
                  on-swipe-left="pendingVisits.showCancelVisitConfirm(visit)">
          <img ng-src="{{visit.visitorImg}}">
          <div layout="row">
            <h2 ng-if="!visit.visitorId">Requested <span
                ng-if="!(pendingVisits.getTimeSinceRequested(visit.createdAt)===0)">{{visit.createdAt |amDifference : null : 'days' }} day </span><span
                ng-if="pendingVisits.getTimeSinceRequested(visit.createdAt)===0">{{visit.createdAt |amDifference : null : 'hours' }} hours </span>ago
            </h2>
            <h2 ng-if="visit.visitorId">{{pendingVisits.getUserFirstName(visit.visitorId)}}</h2>
            <span flex></span>
            <p>{{visit.location.name | limitTo:10}}<span ng-if="visit.location.name.length > 10">...</span></p>
          </div>
          <p>{{visit.notes}}</p>
          <ion-option-button class="button-assertive" ng-click="pendingVisits.showCancelVisitConfirm(visit)">
            Cancel Visit
          </ion-option-button>
        </ion-item>
      </div>
    </ion-list>
  </ion-content>
</ion-view>