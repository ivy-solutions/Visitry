<ion-view title="Choose to Visit" hide-back-button=true>
     <ion-content class="has-header has-tabs">
         <div class="warning" ng-hide="connectionStatus=='ok'">
             No connection to server. ({{connectionStatus}})
         </div>
         <div class="warning" ng-hide="browseVisitRequests.hasAgency">
             You are not yet a member of a group.
         </div>
         <div ng-hide="!browseVisitRequests.hasAgency">
             <div class="emptyListInfo" ng-hide="browseVisitRequests.openVisitCount > 0">
                 <div ng-if="currentUser.userData.location">
                    No requests within {{browseVisitRequests.visitRange }} miles of {{currentUser.userData.location | streetAddress }}
                 </div>
                 <div ng-if="!currentUser.userData.location">
                     No requests available near profile location. Please check your profile and try again.
                 </div>
             </div>
             <ion-list show-delete="browseVisitRequests.showDelete" can-swipe="browseVisitRequests.canSwipe">
                <div ng-repeat="visitsByDate in browseVisitRequests.openVisits">
                    <div class="item item-divider">
                        {{visitsByDate.date|date: "EEEE, MMMM d"}}
                    </div>
                    <ion-item ng-repeat="visit in visitsByDate.visits" class="item-avatar">
                        <img ng-src="{{browseVisitRequests.getRequesterImage(visit)}}" ng-click="browseVisitRequests.visitDetails(visit._id)"/>
                        <a ng-click="browseVisitRequests.visitDetails(visit._id)">
                            <div class="timeOfDay">{{visit.requestedDate | timeOfDay }}</div>
                            <div class="visitInfo">
                                <h2>{{browseVisitRequests.getRequester(visit) | firstNameLastInitial}}
                                    <span class="distance">{{browseVisitRequests.getDistanceToVisitLocation(visit) }}</span></h2>
                                <p>{{visit.notes | limitTo:80 }}{{visit.notes.length >80 ?'...':''}}</p>
                            </div>
                        </a>
                        <ion-option-button class="button-positive" ng-click="browseVisitRequests.scheduleVisit(visit)">
                            Plan Visit
                     </ion-option-button>
                    </ion-item>
                </div>
            </ion-list>
         </div>
    </ion-content>
</ion-view>


